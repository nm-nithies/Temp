elif np.issubdtype(expected_dtype, np.bool_):
    val_str = str(val).strip().lower()
    if val_str == "true":
        scalar_val = expected_dtype.type(True)
    elif val_str == "false":
        scalar_val = expected_dtype.type(False)
    else:
        raise ValueError(f"Only 'True' or 'False' (case-insensitive) are supported for boolean input '{input_name}', but got '{val}'")
