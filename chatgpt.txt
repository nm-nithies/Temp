import torch
import torch.nn as nn

class GatherUnsqueezeModel(nn.Module):
    def __init__(self):
        super().__init__()
        self.data = nn.Parameter(torch.randn(1025, 128))  # Gather source

    def forward(self, indices):
        # indices shape: [1, 1024]
        gathered = torch.gather(self.data, 0, indices.squeeze(0))  # shape: [1024, 128]
        gathered = gathered.unsqueeze(0).unsqueeze(1)  # shape: [1, 1, 1024, 128]
        return gathered
