def get_broadcast_shape(conv_weight_shape, mul_const_shape):
    """
    Returns the shape that the Mul_const tensor should have to broadcast correctly with the conv_weights shape.
    It pads the  Mul_const shape with 1s so the two shapes are compatible for element-wise operations.

    Example:
        broadcast_shape_like((1280, 320, 20, 20), (1280,))
        â†’ [1280, 1, 1, 1]
    """

    shape1 = list(conv_weight_shape)
    shape2 = list(mul_const_shape)

    result_shape = []
    for dim in shape1:
        if dim in shape2:
            result_shape.append(dim)
        else:
            result_shape.append(1)

    return tuple(result_shape)

Maybe also need to check the length and index mapping location?
