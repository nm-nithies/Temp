scale_offset, scale_depth, scale_size = scale[0:3]
clone_bbox = bbox.clone()

offset = scale_offset(clone_bbox[:, 0:2, :, :]).float() * stride
depth = scale_depth(clone_bbox[:, 2:3, :, :]).float().exp()
size = scale_size(clone_bbox[:, 3:6, :, :]).float().exp()

# Keep remaining channels (e.g., rot + vel)
rest = clone_bbox[:, 6:, :, :]  # Assuming remaining 3 channels

# Concatenate to restore original shape: [B, 9, H, W]
bbox = torch.cat([offset, depth, size, rest], dim=1)

return bbox
