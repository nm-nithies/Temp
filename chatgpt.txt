flat_indices = indices.reshape(N, 3)

    fixed_channel = flat_indices[0][1]

    if not np.all(flat_indices[:, 1] == fixed_channel):
        raise ValueError("Channel index is not consistent across batches")
