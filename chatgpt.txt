The issue occurred due to the order in which the two passes were applied. When RemoveTransposeBeforeSoftmax ran before MoveTransposeToEnd, it removed a transpose that was actually needed to maintain the correct input shape for Softmax. This led to incorrect reshaping and an invalid input shape for Softmax. After applying MoveTransposeToEnd, the shape was already transformed, but since the initial transpose was removed earlier, the expected layout was broken. Reordering the passes by applying MoveTransposeToEnd before RemoveTransposeBeforeSoftmax preserves the correct shape throughout the graph and ensures Softmax receives the expected input. This fixes the shape mismatch and keeps the model behavior intact.
