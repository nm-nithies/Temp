                if np.issubdtype(expected_dtype, np.integer):
                    flat_array = np.array([int(v) for v in val_list], dtype=expected_dtype)
                elif np.issubdtype(expected_dtype, np.floating):
                    flat_array = np.array([float(v) for v in val_list], dtype=expected_dtype)
